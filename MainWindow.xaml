<Window
    x:Class="VisorDTE.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:views="using:VisorDTE.Views"
    xmlns:viewmodels="using:VisorDTE.ViewModels"
    mc:Ignorable="d">

    <Grid x:Name="RootGrid" DataContext="{x:Bind ViewModel}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <CommandBar Grid.Row="0" DefaultLabelPosition="Right" Background="Transparent">
            <AppBarButton Icon="OpenFile" Label="Abrir DTE" Command="{Binding OpenFilesCommand}"/>
            <AppBarButton Icon="Save" Label="Exportar a PDF" Command="{Binding ExportToPdfCommand}"/>
            <CommandBar.Content>
                <AutoSuggestBox QueryIcon="Find" PlaceholderText="Buscar por Número de Control..." 
                                Text="{Binding SearchQuery, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                VerticalAlignment="Center"
                                MinWidth="300"/>
            </CommandBar.Content>
        </CommandBar>

        <TabView Grid.Row="1" Margin="0,-1,0,0">
            <TabView.TabItems>
                <TabViewItem Header="Vista por Página">
                    <FlipView ItemsSource="{Binding DteViewModels}"
                              PointerWheelChanged="FlipView_PointerWheelChanged">
                        <FlipView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodels:DteViewModel">
                                <ScrollViewer VerticalScrollBarVisibility="Auto" 
                                              HorizontalScrollBarVisibility="Auto"
                                              ZoomMode="Enabled" MinZoomFactor="0.2">
                                    <views:DteView HorizontalAlignment="Center" VerticalAlignment="Top"/>
                                </ScrollViewer>
                            </DataTemplate>
                        </FlipView.ItemTemplate>
                    </FlipView>
                </TabViewItem>
                <TabViewItem Header="Documento Completo">
                    <ListView ItemsSource="{Binding DteViewModels}" SelectionMode="None">
                        <ListView.ItemTemplate>
                            <DataTemplate x:DataType="viewmodels:DteViewModel">
                                <views:DteView/>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                </TabViewItem>
            </TabView.TabItems>
        </TabView>

        <Grid Grid.Row="2" Padding="12,8" ColumnDefinitions="*,Auto" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}">
            <TextBlock Grid.Column="0" Text="{Binding StatusText}" VerticalAlignment="Center" Foreground="Gray"/>
        </Grid>
    </Grid>
</Window>